pipeline {
    agent any
    
    agent {
        docker {
            image 'maven:3.9.3-eclipse-temurin-17'
            label 'my-defined-label'
            args '-v /tmp:/tmp'
        }
    }
    
    
    triggers {
        cron('H */4 * * 1-5')
    }
    
    parameters {
        string(defaultValue: ''Mr Jenkins'', name: ''PERSON'')
    }
    
    environment {
        CC = 'clang'
    }
    
    tools {
        maven apache-maven-3.0.1
    }
    
    stages {
        stage('Example') {
            
            
            input {
                message "Should we continue?"
                id ''
                ok '"Yes, we should."'
                submitter '"alice,bob"'
                submitterParameter ''
                parameters {
                string(name: ''PERSON'', description: ''Who should I say hello to?'')
                }
            }
            
            when {
                branch pattern: "release-\\d+", comparator: "REGEXP"
                
                environment name: DEPLOY_TO, value: production
                
            }
            
            
            
            steps {
                echo 'Hello World' 
            }
            
            
            
        }
        stage('Stage2') {
            
            
            
            
            
            
            
            
            parallel {
                stage('SubStage') {
                    
                    environment {
                        SERVICE_CREDS = credentials('my-predefined-username-password')
                        AN_ACCESS_KEY = credentials('my-predefined-secret-text')
                    }
                    
                    
                    
                    tools {
                        jdk jdk-17
                    }
                    
                    
                    steps {
                        echo 'this is a test' 
                    }
                    
                    failFast true
                    
                }
            }
            stages {
                stage('SubStage2') {
                    
                    
                    
                    when {
                        not {
                            branch pattern: branchTest
                            
                        }
                        
                    }
                    
                    
                    post {
                    }
                    
                    steps {
                        mvn 1.2.3 
                    }
                    
                    
                    
                }
            }
            
        }
    }
    post {
        always {
             steps {
                 echo 'Hello World' 
             } 
        }
    }
    
}
